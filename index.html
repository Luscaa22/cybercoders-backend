<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CyberCoders | Application</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Poppins}
body{
min-height:100vh;
background:radial-gradient(circle at top,#4b1bff,#090015 60%);
display:flex;
align-items:center;
justify-content:center;
color:#fff
}
.container{
width:100%;
max-width:440px;
background:rgba(255,255,255,.08);
backdrop-filter:blur(18px);
border-radius:20px;
padding:28px;
box-shadow:0 0 40px rgba(140,80,255,.35);
animation:fade .8s ease
}
@keyframes fade{from{opacity:0;transform:translateY(15px)}to{opacity:1}}
.logo{text-align:center;margin-bottom:16px}
.logo img{
width:90px;height:90px;border-radius:50%;
box-shadow:0 0 25px rgba(150,80,255,.7)
}
h1{text-align:center;font-size:22px;margin-bottom:8px}
p.desc{text-align:center;font-size:13px;opacity:.9;margin-bottom:20px}
label{font-size:13px;margin-bottom:4px;display:block}
input,textarea,select{
width:100%;
background:rgba(255,255,255,.12);
border:none;
outline:none;
border-radius:12px;
padding:12px;
color:#fff;
margin-bottom:14px
}
textarea{resize:none;height:90px}
select option{color:#000}
button{
width:100%;
padding:14px;
border:none;
border-radius:14px;
background:linear-gradient(90deg,#7f4bff,#b15cff);
color:#fff;
font-weight:600;
font-size:15px;
cursor:pointer;
transition:.3s
}
button:hover{transform:scale(1.03)}
.footer{text-align:center;margin-top:14px;font-size:11px;opacity:.7}
.hidden{display:none}
.thanks{
display:none;
flex-direction:column;
align-items:center;
text-align:center
}
</style>
</head>

<body>

<!-- FORMULÁRIO -->
<div class="container hidden" id="formContainer">
<div class="logo"><img src="logo.png"></div>

<h1 id="title">Formulário de Administração</h1>
<p class="desc" id="desc">Preencha todas as informações com atenção.</p>

<label>Idioma / Language</label>
<select id="language">
<option value="pt">Português</option>
<option value="en">English</option>
</select>

<form id="form">

<label id="l_name">Nome</label>
<input id="name" type="text" minlength="3" required>

<label id="l_age">Idade</label>
<input id="age" type="number" min="13" required>

<label id="l_discord">Nick no Discord</label>
<input id="discord" type="text" minlength="3" required>

<label id="l_reason">Por que quer entrar na nossa administração</label>
<textarea id="reason" minlength="15" required></textarea>

<label id="l_help">No que você vai contribuir com o servidor</label>
<textarea id="help" minlength="15" required></textarea>

<label id="l_rules">
Se você visse um membro zaralhando o servidor, cometendo racismo, xenofobia, bullying, ou algo do tipo, o que você faria
</label>
<textarea id="rules" minlength="20" required></textarea>

<label id="l_prog">Você sabe alguma linguagem de programação ou alternativa</label>
<select id="prog">
<option value="no">Não</option>
<option value="yes">Sim</option>
</select>

<div id="langs" class="hidden">
<label id="l_langs">Se sim, qual ou quais</label>
<input id="langsInput" type="text">
</div>

<button type="submit" id="send">Enviar formulário</button>
</form>

<div class="footer">Site by: LuscaaDevx</div>
</div>

<!-- FORMULÁRIO FECHADO -->
<div class="container hidden" id="closedContainer">
<div class="logo"><img src="logo.png"></div>
<h1>Formulário Fechado</h1>
<p class="desc">
O formulário de administração do <b>CyberCoders Studio</b> está fechado no momento.<br>
Aguarde a abertura de novas vagas.
</p>
<div class="footer">Site by: LuscaaDevx</div>
</div>

<!-- OBRIGADO -->
<div class="container thanks" id="thanks">
<div class="logo"><img src="logo.png"></div>
<h2>Obrigado por enviar!</h2>
<p>Aguarde a correção da equipe.</p>
</div>

<script>
const form=document.getElementById("form")
const formContainer=document.getElementById("formContainer")
const closedContainer=document.getElementById("closedContainer")
const thanks=document.getElementById("thanks")
const prog=document.getElementById("prog")
const langs=document.getElementById("langs")

prog.onchange=()=>langs.classList.toggle("hidden",prog.value!=="yes")

async function checkFormStatus(){
const res=await fetch("/api/submit",{method:"GET"})
if(res.status===403||res.status===405){
closedContainer.classList.remove("hidden")
}else{
formContainer.classList.remove("hidden")
}
}

form.addEventListener("submit",async e=>{
e.preventDefault()
if(parseInt(age.value)<13){alert("Idade mínima permitida é 13 anos.");return}

const fields=[]
form.querySelectorAll("input,textarea,select").forEach(el=>{
if(!el.value||el.id==="language")return
const label=el.previousElementSibling?el.previousElementSibling.innerText:"Campo"
fields.push({name:label,value:el.value.slice(0,1024)})
})

const res=await fetch("/api/submit",{
method:"POST",
headers:{"Content-Type":"application/json"},
body:JSON.stringify({fields})
})

if(!res.ok){
formContainer.classList.add("hidden")
closedContainer.classList.remove("hidden")
return
}

formContainer.style.display="none"
thanks.style.display="flex"
})

checkFormStatus()
</script>

</body>
</html>
